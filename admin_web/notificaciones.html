<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Notificaciones</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-material-design.min.css">
  <link rel="stylesheet" href="css/all.css">
  <link rel="stylesheet" href="css/sweetalert2.min.css">
  <link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600&family=Syne:wght@700;800&display=swap"
    rel="stylesheet">

  <style>
    :root {
      --primary: #0ea5e9;
      --primary-dark: #0284c7;
      --primary-light: #e0f2fe;
      --success: #10b981;
      --danger: #ef4444;
      --warning: #f59e0b;
      --bg: #f1f5f9;
      --surface: #ffffff;
      --border: #e2e8f0;
      --text: #1e293b;
      --muted: #94a3b8;
      --radius: 14px;
      --shadow: 0 4px 24px rgba(0, 0, 0, 0.07);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      overflow: hidden;
      font-family: 'DM Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .main-container {
      height: 100vh;
      display: flex;
    }

    .page-content {
      flex: 1;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      background: var(--bg);
    }

    .full-box.navbar-info {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 0 20px;
      height: 52px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .page-header-custom {
      padding: 18px 24px 10px;
    }

    .page-header-custom h3 {
      font-family: 'Syne', sans-serif;
      font-size: 22px;
      font-weight: 800;
      color: var(--text);
      margin: 0 0 2px;
    }

    .page-header-custom p {
      font-size: 13px;
      color: var(--muted);
      margin: 0;
    }

    .scroll-area {
      flex: 1;
      overflow-y: auto;
      padding: 0 24px 30px;
    }

    .scroll-area::-webkit-scrollbar {
      width: 6px;
    }

    .scroll-area::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 10px;
    }

    /* NAV TABS */
    .nav-tabs-custom {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      padding-top: 4px;
    }

    .nav-tab-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 9px 18px;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      font-family: 'DM Sans', sans-serif;
      text-decoration: none;
      transition: all .2s;
      border: 1.5px solid var(--border);
      background: var(--surface);
      color: var(--muted);
    }

    .nav-tab-btn:hover {
      color: var(--primary);
      border-color: var(--primary);
      text-decoration: none;
    }

    .nav-tab-btn.active {
      background: var(--primary);
      color: #fff;
      border-color: var(--primary);
      box-shadow: 0 4px 14px rgba(14, 165, 233, .3);
    }

    /* CARDS */
    .form-card {
      background: var(--surface);
      border-radius: var(--radius);
      border: 1.5px solid var(--border);
      margin-bottom: 16px;
      overflow: hidden;
      box-shadow: var(--shadow);
      animation: fadeUp .35s ease both;
    }

    .form-card:nth-child(2) {
      animation-delay: .06s;
    }

    .form-card:nth-child(3) {
      animation-delay: .12s;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .form-card-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 14px 20px;
      border-bottom: 1.5px solid var(--border);
      background: #fafbfc;
    }

    .icon-box {
      width: 34px;
      height: 34px;
      border-radius: 9px;
      background: var(--primary-light);
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 15px;
      flex-shrink: 0;
    }

    .icon-box.green {
      background: #d1fae5;
      color: var(--success);
    }

    .icon-box.yellow {
      background: #fef3c7;
      color: var(--warning);
    }

    .form-card-header h6 {
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 14px;
      margin: 0;
      color: var(--text);
    }

    .form-card-header small {
      font-size: 12px;
      color: var(--muted);
      display: block;
    }

    .form-card-body {
      padding: 20px;
    }

    /* INPUTS */
    .field-group {
      margin-bottom: 16px;
    }

    .field-group label {
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
      letter-spacing: .05em;
      text-transform: uppercase;
      display: block;
      margin-bottom: 6px;
    }

    .field-group input,
    .field-group textarea,
    .field-group select {
      width: 100%;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 14px;
      font-family: 'DM Sans', sans-serif;
      color: var(--text);
      background: var(--surface);
      transition: border-color .2s, box-shadow .2s;
      outline: none;
    }

    .field-group input {
      height: 42px;
    }

    .field-group input:focus,
    .field-group textarea:focus,
    .field-group select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(14, 165, 233, .12);
    }

    .field-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .field-group select {
      height: 42px;
    }

    /* STATS BADGE */
    .stats-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--bg);
      border: 1.5px solid var(--border);
      border-radius: 20px;
      padding: 5px 12px;
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
    }

    .stats-badge .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--success);
    }

    .stats-badge .dot.red {
      background: var(--danger);
    }

    /* SELECCIONADOS */
    .sel-count-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: var(--primary);
      color: #fff;
      border-radius: 20px;
      padding: 2px 10px;
      font-size: 12px;
      font-weight: 700;
      min-width: 28px;
    }

    .sel-list {
      max-height: 160px;
      overflow-y: auto;
      border: 1.5px solid var(--border);
      border-radius: 10px;
      background: var(--bg);
      padding: 8px;
    }

    .sel-list::-webkit-scrollbar {
      width: 4px;
    }

    .sel-list::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }

    .sel-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 7px 10px;
      border-radius: 8px;
      background: var(--surface);
      border: 1px solid var(--border);
      margin-bottom: 6px;
      font-size: 13px;
    }

    .sel-item:last-child {
      margin-bottom: 0;
    }

    .sel-item strong {
      color: var(--text);
    }

    .sel-item small {
      color: var(--muted);
      font-size: 11px;
    }

    .sel-item-remove {
      background: none;
      border: none;
      color: var(--danger);
      cursor: pointer;
      font-size: 16px;
      padding: 0 4px;
      line-height: 1;
      transition: opacity .2s;
    }

    .sel-item-remove:hover {
      opacity: .7;
    }

    /* BOTONES */
    .btn-primary-custom {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 10px 22px;
      font-size: 14px;
      font-weight: 600;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      transition: transform .15s, box-shadow .2s, opacity .2s;
      box-shadow: 0 4px 14px rgba(14, 165, 233, .35);
    }

    .btn-primary-custom:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(14, 165, 233, .4);
    }

    .btn-primary-custom:disabled {
      opacity: .6;
      cursor: not-allowed;
      transform: none;
    }

    .btn-success-custom {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--success);
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 10px 22px;
      font-size: 14px;
      font-weight: 600;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      transition: background .2s, transform .15s;
      box-shadow: 0 4px 14px rgba(16, 185, 129, .3);
    }

    .btn-success-custom:hover {
      background: #059669;
      transform: translateY(-1px);
    }

    .btn-success-custom:disabled {
      opacity: .6;
      cursor: not-allowed;
      transform: none;
    }

    .btn-outline-custom {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      background: transparent;
      color: var(--muted);
      border: 1.5px solid var(--border);
      border-radius: 10px;
      padding: 9px 16px;
      font-size: 13px;
      font-weight: 600;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      transition: border-color .2s, color .2s;
    }

    .btn-outline-custom:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .btn-add-emp {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      background: var(--primary-light);
      color: var(--primary);
      border: 1.5px solid var(--primary);
      border-radius: 10px;
      padding: 9px 18px;
      font-size: 13px;
      font-weight: 600;
      font-family: 'DM Sans', sans-serif;
      cursor: pointer;
      transition: background .2s, color .2s;
      width: 100%;
      justify-content: center;
    }

    .btn-add-emp:hover {
      background: var(--primary);
      color: #fff;
    }

    .actions-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    i {
      transform: none !important;
      filter: none !important;
    }

    @media (max-width: 768px) {

      html,
      body {
        overflow: auto;
      }

      .page-content {
        overflow: auto;
        height: auto;
      }

      .scroll-area {
        overflow: visible;
      }

      .actions-row {
        flex-direction: column;
      }

      .btn-primary-custom,
      .btn-success-custom {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>

<body>
  <main class="full-box main-container">

    <!-- NAV LATERAL -->
    <section class="full-box nav-lateral">
      <div class="full-box nav-lateral-bg show-nav-lateral"></div>
      <div class="full-box nav-lateral-content">
        <figure class="full-box nav-lateral-avatar">
          <i class="far fa-times-circle show-nav-lateral"></i>
          <img src="assets/avatar/Avatar2.png" class="img-fluid" alt="Avatar">
          <figcaption class="roboto-medium text-center">
            Administrador <br><small class="roboto-condensed-light">Gestión</small>
          </figcaption>
        </figure>
        <nav class="full-box nav-lateral-menu">
          <ul>
            <li><a href="dashboard.html"><i class="fab fa-dashcube fa-fw"></i> &nbsp; Dashboard</a></li>
            <li><a class="active" href="notificaciones.html"><i class="fas fa-bell fa-fw"></i> &nbsp; Notificaciones</a>
            </li>
            <li><a href="notificaciones-list.html"><i class="fas fa-list fa-fw"></i> &nbsp; Lista Notificaciones</a>
            </li>

          </ul>
        </nav>
      </div>
    </section>

    <!-- CONTENIDO -->
    <section class="full-box page-content">
      <nav class="full-box navbar-info">
        <a href="#" class="float-left show-nav-lateral"><i class="fas fa-exchange-alt"></i></a>
        <a href="#" onclick="cerrarSesion()"><i class="fas fa-power-off"></i></a>
      </nav>

      <div class="page-header-custom">
        <h3><i class="fas fa-bell fa-fw"></i> &nbsp; Notificaciones</h3>
        <p>Envía avisos a uno o varios empleados desde el panel.</p>
      </div>

      <div class="scroll-area">

        <!-- TABS -->
        <div class="nav-tabs-custom">
          <a href="notificaciones-list.html" class="nav-tab-btn">
            <i class="fas fa-list"></i> Lista de Notificaciones
          </a>
          <a href="notificaciones.html" class="nav-tab-btn active">
            <i class="fas fa-bell"></i> Enviar Notificación
          </a>
        </div>

        <div class="row">

          <!-- COLUMNA IZQUIERDA: Selección de empleados -->
          <div class="col-md-6">

            <!-- Card selección -->
            <div class="form-card">
              <div class="form-card-header">
                <div class="icon-box"><i class="fas fa-users"></i></div>
                <div>
                  <h6>Seleccionar Empleados</h6>
                  <small>Busca y agrega destinatarios</small>
                </div>
              </div>
              <div class="form-card-body">

                <!-- Stats tokens -->
                <div class="d-flex align-items-center gap-2 mb-3" style="gap:8px; display:flex; flex-wrap:wrap;">
                  <span class="stats-badge">
                    <span class="dot"></span>
                    Con token: <strong id="conToken">0</strong>
                  </span>
                  <span class="stats-badge">
                    <span class="dot red"></span>
                    Sin token: <strong id="sinToken">0</strong>
                  </span>
                  <button class="btn-outline-custom" id="btnReload" style="padding:5px 12px; font-size:12px;">
                    <i class="fas fa-sync-alt"></i> Actualizar
                  </button>
                </div>

                <!-- Buscador + combo -->
                <div class="field-group">
                  <label>Buscar empleado</label>
                  <input type="text" id="buscarEmpleado" placeholder="Nombre, cédula o ID...">
                </div>

                <div class="field-group">
                  <label>Empleado</label>
                  <select id="comboEmpleados"></select>
                </div>

                <button class="btn-add-emp mb-3" id="btnAgregarSeleccion">
                  <i class="fas fa-plus"></i> Agregar a selección
                </button>

                <div class="d-flex justify-content-between align-items-center mb-2"
                  style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;">
                  <button class="btn-outline-custom" id="btnSelectAll" style="font-size:12px; padding:6px 12px;">
                    <i class="fas fa-check-double"></i> Seleccionar todos
                  </button>
                  <button class="btn-outline-custom" id="btnCopyIds" style="font-size:12px; padding:6px 12px;">
                    <i class="fas fa-copy"></i> Copiar IDs
                  </button>
                </div>

              </div>
            </div>

            <!-- Card seleccionados -->
            <div class="form-card">
              <div class="form-card-header">
                <div class="icon-box green"><i class="fas fa-user-check"></i></div>
                <div>
                  <h6>Seleccionados &nbsp;<span class="sel-count-badge" id="selCountBadge">0</span></h6>
                  <small>Empleados que recibirán la notificación</small>
                </div>
              </div>
              <div class="form-card-body">
                <div class="sel-list" id="seleccionadosResumen">
                  <div style="text-align:center; color:var(--muted); font-size:13px; padding:16px 0;">
                    Ningún empleado seleccionado
                  </div>
                </div>
              </div>
            </div>

          </div>

          <!-- COLUMNA DERECHA: Mensaje y envío -->
          <div class="col-md-6">

            <!-- Card mensaje -->
            <div class="form-card">
              <div class="form-card-header">
                <div class="icon-box yellow"><i class="fas fa-envelope"></i></div>
                <div>
                  <h6>Mensaje</h6>
                  <small>Título y cuerpo de la notificación</small>
                </div>
              </div>
              <div class="form-card-body">
                <div class="field-group">
                  <label>Título</label>
                  <input type="text" id="titulo" placeholder="Ej: Reunión urgente">
                </div>
                <div class="field-group">
                  <label>Mensaje</label>
                  <textarea id="cuerpo" placeholder="Escribe el contenido de la notificación..."></textarea>
                </div>
              </div>
            </div>

            <!-- Card acciones -->
            <div class="form-card">
              <div class="form-card-header">
                <div class="icon-box"><i class="fas fa-paper-plane"></i></div>
                <div>
                  <h6>Enviar</h6>
                  <small>Elige cómo deseas enviar la notificación</small>
                </div>
              </div>
              <div class="form-card-body">
                <div class="actions-row">
                  <button class="btn-primary-custom" id="enviar">
                    <i class="fas fa-paper-plane"></i> Enviar a seleccionados
                  </button>
                  <button class="btn-success-custom" id="btnBroadcast">
                    <i class="fas fa-bullhorn"></i> Broadcast (todos)
                  </button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="js/bootstrap-material-design.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.26.20/dist/sweetalert2.all.min.js"></script>
  <script>$(function () { $('body').bootstrapMaterialDesign(); });</script>
  <script src="js/main.js"></script>
  <script src="js/admin-api.js"></script>
  <script src="js/logout.js"></script>
  <script src="js/notificaciones.js"></script>
</body>

</html>